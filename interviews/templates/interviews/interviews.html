{% extends 'home/base.html' %}
{% load static %}

{% block content %}
<section class="py-16">
  <div class="max-w-6xl mx-auto px-4">

    <!-- Sarlavha -->
    <h1 class="text-4xl font-extrabold text-center mb-12 tracking-tight
               bg-gradient-to-r from-blue-600 via-purple-600 to-blue-600
               bg-clip-text text-transparent">
      Intervyular
    </h1>

    <!-- Grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-10">
      {% for video in videos %}
      <div class="group relative rounded-3xl p-[2px]
                  bg-gradient-to-br from-blue-300 via-purple-300 to-blue-300
                  hover:scale-[1.02] transition-transform duration-500">

        <!-- Ichki oq qism -->
        <div class="bg-white rounded-3xl overflow-hidden shadow-sm
                    transition-all duration-500 group-hover:shadow-lg">

          <!-- Rasm -->
          <div class="relative h-52 overflow-hidden">
            <img src="{{ video.image.url }}"
                 alt="{{ video.student_name }}"
                 class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110">

            <!-- Play Icon -->
            {% if video.youtube_id %}
            <button onclick="openModal('{{ video.youtube_id }}')"
                    class="absolute inset-0 flex items-center justify-center
                           bg-gradient-to-t from-black/40 via-black/10 to-transparent
                           opacity-0 group-hover:opacity-100 transition duration-500">
              <i class="fas fa-play-circle text-white text-5xl drop-shadow-lg"></i>
            </button>
            {% endif %}
          </div>

          <!-- Kontent -->
          <div class="p-5">
            <h2 class="text-xl font-bold text-gray-800 mb-1">{{ video.student_name }}</h2>
            <p class="text-sm text-gray-500 mb-3">{{ video.country }}</p>
          </div>
        </div>
      </div>
      {% empty %}
      <p class="col-span-full text-center text-gray-500">
        Hozircha intervyular mavjud emas.
      </p>
      {% endfor %}
    </div>

  </div>
</section>

<!-- MODAL -->
<div id="videoModal"
     class="hidden fixed inset-0 bg-black/70 flex items-center justify-center z-50">
  <div class="relative bg-white rounded-2xl overflow-hidden w-11/12 md:w-2/3 lg:w-1/2">
    <button onclick="closeModal()"
            class="absolute top-2 right-2 bg-black/50 text-white rounded-full w-8 h-8
                   flex items-center justify-center hover:bg-black/70 transition">
      &times;
    </button>
    <iframe id="videoFrame" class="w-full aspect-video" src="" frameborder="0"
            allow="autoplay; encrypted-media" allowfullscreen></iframe>
  </div>
</div>

<!-- JS -->
<script>
  function openModal(youtubeId) {
    const modal = document.getElementById('videoModal');
    const frame = document.getElementById('videoFrame');
    frame.src = `https://www.youtube.com/embed/${youtubeId}?autoplay=1`;
    modal.classList.remove('hidden');
  }

  function closeModal() {
    const modal = document.getElementById('videoModal');
    const frame = document.getElementById('videoFrame');
    frame.src = ''; // videoni toâ€˜xtatish
    modal.classList.add('hidden');
  }
</script>

{% endblock %}
